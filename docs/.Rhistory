lm(DGEO~DSOM)
plot(DGEO,DSOM)
plot(DGEO,DSOM)
library(summarytools)
library(sp)
library(rgeos)
library(rgdal)
CLUSTER<-readOGR('data/CLUSTER.shp')
o<-as.data.frame(matrix(0,81,81))
colnames(o)<-1:81
t<-as.matrix(cbind(9:1,18:10,27:19,36:28,45:37,54:46,63:55,72:64,81:73))
C<-1
for(j in 1:dim(t)[2]){
for(i in 1:dim(t)[1]){
F<-1
for(l in 1:dim(t)[2]){
for(k in 1:dim(t)[1]){
d<-max(c(abs(i-k),abs(j-l)))
o[F,C]<-d
F<-F+1
}
}
C<-C+1
}
}
centroides<-gCentroid(CLUSTER,byid = TRUE)
dist<-spDists(centroides)
dist<-as.data.frame(dist)
colnames(dist)<-as.numeric(rownames(centroides@coords))+1
rownames(dist)<-as.numeric(rownames(centroides@coords))+1
O<-as.data.frame(matrix(0,length(colnames(dist)),length(colnames(dist))))
colnames(O)<-colnames(dist)
rownames(O)<-colnames(dist)
for(i in 1:dim(O)[1]){
for(j in 1:dim(O)[2]){
Nf<-CLUSTER$NEUR[i]
Nc<-CLUSTER$NEUR[j]
D<-o[Nf,Nc]
O[i,j]<-D
}
}
DGEO<-NULL
for(i in 2:dim(dist)[1]){
for(j in 1:(i-1)){
DGEO<-c(DGEO,dist[i,j])
}
}
DSOM<-NULL
for(i in 2:dim(O)[1]){
for(j in 1:(i-1)){
DSOM<-c(DSOM,O[i,j])
}
}
plot(DSOM,DGEO)
cor(DSOM,DGEO)
names(CLUSTER)
boxplot(subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==1)$PEJH14)
library(SOMbrero)
library(dplyr)
library(ggplot2)
library(markdown)
library(summarytools)
options(scipen = 999)
set.seed(67)
ANALISIS<-read.csv('data/DB.csv')
ncel=round(sqrt(5*sqrt(dim(ANALISIS)[1])),digits=0)
training<-trainSOM(x.data=select(ANALISIS,PEJH12,TII,DBI,H,PHZ),
dimension=c(ncel,ncel),
radius.type='letremy',
verbose=TRUE,
maxit=5000)
summary(training)
plot(training,what ='obs',show.names = FALSE)
nclas=6
scEST_S7<-superClass(training,k=nclas)
plot(scEST_S7,lwd=1.5)
plot(scEST_S7,type='grid',plot.legend=TRUE,show.names = FALSE)
plot(training, what="obs", type="color", variable=1, print.title=FALSE, main='Porcentaje Escolaridad del Jefe de hogar menor a 12') + geom_raster()
plot(training, what="obs", type="color", variable=2, print.title=FALSE, main='Tasa Inmigración Intrametropolitana') + geom_raster()
plot(training, what="obs", type="color", variable=3, print.title=FALSE, main='Distancias al Bicentro más cercano') + geom_raster()
plot(training, what="obs", type="color", variable=4, print.title=FALSE, main='Diversidad de Usos de Suelo') + geom_raster()
plot(training, what="obs",type="color", variable=5, print.title =FALSE, main='Porcentaje Hacinamiento Zonal') + geom_raster()
ID   <-names(training$clustering)
NEUR <-as.integer(training$clustering)
CLUSTER<-rep(0,length(NEUR))
for(i in 1:length(NEUR)){ CLUSTER[i]<-scEST_S7$cluster[NEUR[i]] }
MERGE<-merge(data.frame(ID,NEUR,CLUSTER), select(ANALISIS, ID,PEJH12,TII,H,PHZ,DBI), by.x="ID", by.y="ID")
summary(subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==1))
summary(subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==2))
summary(subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==3))
summary(subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==4))
summary(subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==5))
summary(subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==6))
boxplot(subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==1)$PEJH14)
boxplot(subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==1)$PEJH12)
boxplot(subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==1)$PEJH12,subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==1)$TII)
boxplot(subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==1)$PEJH12,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==2)$PEJH12,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==3)$PEJH12,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==4)$PEJH12,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==5)$PEJH12,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==6)$PEJH12)
boxplot(subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==1)$PEJH12,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==2)$PEJH12,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==3)$PEJH12,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==4)$PEJH12,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==5)$PEJH12,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==6)$PEJH12)
boxplot(subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==1)$TII,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==2)$TII,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==3)$TII,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==4)$TII,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==5)$TII,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==6)$TII)
boxplot(subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==1)$PHZ,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==2)$PHZ,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==3)$PHZ,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==4)$PHZ,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==5)$PHZ,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==6)$PHZ)
boxplot(subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==1)$H,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==2)$H,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==3)$H,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==4)$H,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==5)$H,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==6)$H)
boxplot(subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==1)$DBI,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==2)$DBI,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==3)$DBI,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==4)$DBI,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==5)$DBI,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==6)$DBI)
boxplot(subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==1)$PEJH12,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==2)$PEJH12,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==3)$PEJH12,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==4)$PEJH12,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==5)$PEJH12,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==6)$PEJH12,
main="Comparación cluster según Porcentaje Escolaridad de Jefes de hogar con menos de 12",
xlab="Cluster",
ylab="Porcentaje")
boxplot(subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==1)$PEJH12,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==2)$PEJH12,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==3)$PEJH12,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==4)$PEJH12,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==5)$PEJH12,
subset(select(ANALISIS,PEJH12,TII,PHZ,H,DBI),CLUSTER==6)$PEJH12,
main="Porcentaje Escolaridad de Jefes de hogar con menos de 12",
xlab="Cluster",
ylab="Porcentaje")
names(ANALISIS)
library(SOMbrero)
library(dplyr)
library(ggplot2)
library(markdown)
library(rgdal)
options(scipen = 999)
set.seed(67)
ANALISIS<-read.csv('data/DB.csv')
SHP<-as.data.frame(readOGR('data/CLUSTER.shp'))
ncel=round(sqrt(5*sqrt(dim(ANALISIS)[1])),digits=0)
training<-trainSOM(x.data=select(ANALISIS,PEJH12,TII,DBI,H,PHZ),
dimension=c(ncel,ncel),
radius.type='letremy',
verbose=TRUE,
maxit=5000)
nclas=6
scEST_S7<-superClass(training,k=nclas)
```{r}
names(SHP)
select(SHP,CLUSTER)
class((SHP))
names(SHP)
boxplot(subset(select(SHP,PEJH14,TII,PHZ,H,DBI),CLUSTER==1)$PEJH14,
subset(select(SHP,PEJH14,TII,PHZ,H,DBI),CLUSTER==2)$PEJH14,
subset(select(SHP,PEJH14,TII,PHZ,H,DBI),CLUSTER==3)$PEJH14,
subset(select(SHP,PEJH14,TII,PHZ,H,DBI),CLUSTER==4)$PEJH14,
subset(select(SHP,PEJH14,TII,PHZ,H,DBI),CLUSTER==5)$PEJH14,
subset(select(SHP,PEJH14,TII,PHZ,H,DBI),CLUSTER==6)$PEJH14,
main="Porcentaje Escolaridad de Jefes de hogar con menos de 12",
xlab="Cluster",
ylab="Porcentaje")
library(SOMbrero)
library(dplyr)
library(ggplot2)
library(markdown)
library(rgdal)
options(scipen = 999)
set.seed(67)
ANALISIS<-read.csv('data/DB.csv')
SHP<-as.data.frame(readOGR('data/CLUSTER.shp'))
ncel=round(sqrt(5*sqrt(dim(ANALISIS)[1])),digits=0)
training<-trainSOM(x.data=select(ANALISIS,PEJH12,TII,DBI,H,PHZ),
dimension=c(ncel,ncel),
radius.type='letremy',
verbose=TRUE,
maxit=5000)
nclass=6
scEST_S7<-superClass(training,k=nclass)
plot(scEST_S7)
boxplot(subset(select(SHP,PEJH14,TII,PHZ,H,DBI),CLUSTER==1)$PEJH14,
subset(select(SHP,PEJH14,TII,PHZ,H,DBI),CLUSTER==2)$PEJH14,
subset(select(SHP,PEJH14,TII,PHZ,H,DBI),CLUSTER==3)$PEJH14,
subset(select(SHP,PEJH14,TII,PHZ,H,DBI),CLUSTER==4)$PEJH14,
subset(select(SHP,PEJH14,TII,PHZ,H,DBI),CLUSTER==5)$PEJH14,
subset(select(SHP,PEJH14,TII,PHZ,H,DBI),CLUSTER==6)$PEJH14,
main="Porcentaje Escolaridad de Jefes de hogar con menos de 12",
xlab="Cluster",
ylab="Porcentaje")
boxplot(subset(select(SHP,PEJH14,TII,PHZ,H,DBI),CLUSTER==1)$PHZ,
subset(select(SHP,PEJH14,TII,PHZ,H,DBI),CLUSTER==2)$PHZ,
subset(select(SHP,PEJH14,TII,PHZ,H,DBI),CLUSTER==3)$PHZ,
subset(select(SHP,PEJH14,TII,PHZ,H,DBI),CLUSTER==4)$PHZ,
subset(select(SHP,PEJH14,TII,PHZ,H,DBI),CLUSTER==5)$PHZ,
subset(select(SHP,PEJH14,TII,PHZ,H,DBI),CLUSTER==6)$PHZ,
main="Porcentaje Escolaridad de Jefes de hogar con menos de 12",
xlab="Cluster",
ylab="Porcentaje")
boxplot(subset(select(SHP,PEJH14,TII,PHZ,H,DBI),CLUSTER==1)$PEJH14,
subset(select(SHP,PEJH14,TII,PHZ,H,DBI),CLUSTER==2)$PEJH14,
subset(select(SHP,PEJH14,TII,PHZ,H,DBI),CLUSTER==3)$PEJH14,
subset(select(SHP,PEJH14,TII,PHZ,H,DBI),CLUSTER==4)$PEJH14,
subset(select(SHP,PEJH14,TII,PHZ,H,DBI),CLUSTER==5)$PEJH14,
subset(select(SHP,PEJH14,TII,PHZ,H,DBI),CLUSTER==6)$PEJH14,
main="Porcentaje Escolaridad de Jefes de hogar con menos de 12",
xlab="Cluster",
ylab="Porcentaje")
plot(scEST_S7)
plot(scEST_S7)
plot(scEST_S7)
library(rgdal)
library(sp)
library(leaflet)
SHP<-as.data.frame(readOGR('data/CLUSTER.shp'))
library(rgdal)
library(sp)
library(leaflet)
SHP<-as.data.frame(readOGR('data/CLUSTER.shp'))
library(rgdal)
library(sp)
library(leaflet)
SHP<-as.data.frame(readOGR('data/CLUSTER.shp'))
library(leaflet)
l <- leaflet() %>%
setView(lat = 50.85045, lng = 4.34878, zoom=13) %>%
addTiles(group="OSM") %>%
addProviderTiles(providers$CartoDB.DarkMatter, group="Dark") %>%
addProviderTiles(providers$CartoDB.Positron, group="Light") %>%
addLayersControl(baseGroups=c('OSM','Dark','Light'))
frameWidget(l)
install.packages('widgetframe')
library(rgdal)
library(sp)
library(leaflet)
library(widgetframe)
SHP<-as.data.frame(readOGR('data/CLUSTER.shp'))
l <- leaflet() %>%
setView(lat = 50.85045, lng = 4.34878, zoom=13) %>%
addTiles(group="OSM") %>%
addProviderTiles(providers$CartoDB.DarkMatter, group="Dark") %>%
addProviderTiles(providers$CartoDB.Positron, group="Light") %>%
addLayersControl(baseGroups=c('OSM','Dark','Light'))
frameWidget(l)
l <- leaflet() %>%
setView(lat = 50.85045, lng = 4.34878, zoom=13) %>%
addTiles(group="OSM") %>%
addProviderTiles(providers$CartoDB.Positron, group="Light") %>%
addLayersControl(baseGroups=c('OSM','Dark','Light'))
frameWidget(l)
l <- leaflet() %>%
setView(lng = -73, lat = .36, zoom = 12)
l <- leaflet() %>%
setView(lng = -73, lat = -36, zoom = 12)
m <- leaflet() %>%
setView(lng = -73, lat = -36, zoom = 12)
m %>% addTiles()
m <- leaflet() %>%
setView(lng = -73.0502777778, lat = -36.8272222222, zoom = 12)
m %>% addTiles()
m <- leaflet() %>%
setView(lng = -73.0502777778, lat = -36.8272222222, zoom = 10)
m %>% addTiles()
m <- leaflet() %>%
setView(lng = -73.0502777778, lat = -36.8272222222, zoom = 11)
m %>% addTiles()
m <- leaflet() %>%
setView(lng = -73.0502777778, lat = -36.8272222222, zoom = 15)
m %>% addTiles()
m <- leaflet() %>%
setView(lng = -73.0502777778, lat = -36.8272222222, zoom = 5)
m %>% addTiles()
m <- leaflet() %>%
setView(lng = -73.0502777778, lat = -36.8272222222, zoom = 9)
m %>% addTiles()
m <- leaflet() %>%
setView(lng = -73.0502777778, lat = -36.8272222222, zoom = 12)
m %>% addTiles()
m <- leaflet() %>%
setView(lng = -73.0502777778, lat = -36.8272222222, zoom = 10)
m %>% addTiles()
m <- leaflet() %>%
setView(lng = -73.0502777778, lat = -36.8272222222, zoom = 11)
m %>% addTiles()
m <- leaflet() %>%
setView(lng = -73.0502777778, lat = -36.8272222222, zoom = 9)
m %>% addTiles()
m <- leaflet() %>%
setView(lng = -73.0502777778, lat = -36.8272222222, zoom = 11)
m %>% addTiles()
m <- leaflet() %>%
setView(lng = -73.0502777778, lat = -36.8272222222, zoom = 11)
m %>% addProviderTiles(providers$CartoDB.Positron)
m <- leaflet() %>%
setView(lng = -73.0502777778, lat = -36.8272222222, zoom = 11)
m %>% addProviderTiles(providers$Stamen.Toner)
m <- leaflet() %>%
setView(lng = -73.0502777778, lat = -36.8272222222, zoom = 11)
m %>% addProviderTiles(providers$CartoDB.Positron)
m <- leaflet(SHP) %>%
setView(lng = -73.0502777778, lat = -36.8272222222, zoom = 11)
m %>% addProviderTiles(providers$CartoDB.Positron)
m <- leaflet(SHP) %>%
setView(lng = -73.0502777778, lat = -36.8272222222, zoom = 11)
m %>% addProviderTiles(providers$CartoDB.Positron)%>%
addPolygons(color = "#444444", weight = 1, smoothFactor = 0.5,
opacity = 1.0, fillOpacity = 0.5,
fillColor = ~colorQuantile("YlOrRd", ALAND)(ALAND),
highlightOptions = highlightOptions(color = "white", weight = 2,
bringToFront = TRUE))
leaflet(SHP) %>%
addTiles() %>%
addPolygons(data=adm, weight = 2, fillColor = "yellow", popup=popup)
leaflet(SHP) %>%
addTiles() %>%
addPolygons(data=SHP, weight = 2, fillColor = "yellow", popup=popup)
m <- leaflet(SHP) %>%
setView(lng = -73.0502777778, lat = -36.8272222222, zoom = 11)
m %>% addProviderTiles(providers$CartoDB.Positron)
m <- leaflet(SHP) %>%
setView(lng = -73.0502777778, lat = -36.8272222222, zoom = 11)
m %>% addProviderTiles(providers$CartoDB.Positron)
m  %>%addPolygons(data=SHP,weight=5,col = 'red')
library(rgdal)
library(sp)
library(leaflet)
library(widgetframe)
SHP<-readOGR('data/CLUSTER.shp')
m <- leaflet(SHP) %>%
setView(lng = -73.0502777778, lat = -36.8272222222, zoom = 11)
m %>% addProviderTiles(providers$CartoDB.Positron)
m  %>%addPolygons(data=SHP,weight=5,col = 'red')
m <- leaflet(SHP) %>%
setView(lng = -73.0502777778, lat = -36.8272222222, zoom = 11)
m %>% addProviderTiles(providers$CartoDB.Positron) %>% addPolygons(data=SHP,weight=5,col = 'red')
library(rgdal)
library(sp)
library(leaflet)
library(widgetframe)
SHP<-readOGR('data/CLUSTER.shp')
shapeData <- spTransform(SHP, CRS("+proj=longlat +datum=WGS84 +no_defs"))
m <- leaflet(SHP) %>%
setView(lng = -73.0502777778, lat = -36.8272222222, zoom = 11)
m %>% addProviderTiles(providers$CartoDB.Positron) %>% addPolygons(data=shapeData,weight=5,col = 'red')
m <- leaflet(SHP) %>%
setView(lng = -73.0502777778, lat = -36.8272222222, zoom = 11)
m %>% addProviderTiles(providers$CartoDB.Positron) %>% addPolygons(data=shapeData,weight=1,col = 'red')
